name: Deploy to cPanel

on:
  push:
    branches:
      - main  # Use the correct default branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Validate .cpanel.yml
        run: |
          if [ ! -f .cpanel.yml ]; then
            echo ".cpanel.yml file is missing. Deployment cannot proceed."
            exit 1
          fi

      - name: Deploy to cPanel
  env:
    CPANEL_USERNAME: ${{ secrets.CPANEL_USERNAME }}
    CPANEL_PASSWORD: ${{ secrets.CPANEL_PASSWORD }}
    CPANEL_URL: ${{ secrets.CPANEL_URL }}
  run: |
    echo "Deploying to cPanel"
    curl -T ./public_html/* --user "$CPANEL_USERNAME:$CPANEL_PASSWORD" "$CPANEL_URL/"
