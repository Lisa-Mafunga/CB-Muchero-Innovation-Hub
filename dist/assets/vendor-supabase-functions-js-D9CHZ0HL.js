var v=function(){return v=Object.assign||function(r){for(var n,e=1,a=arguments.length;e<a;e++){n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},v.apply(this,arguments)};function F(t,r){var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.indexOf(e)<0&&(n[e]=t[e]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,e=Object.getOwnPropertySymbols(t);a<e.length;a++)r.indexOf(e[a])<0&&Object.prototype.propertyIsEnumerable.call(t,e[a])&&(n[e[a]]=t[e[a]]);return n}function j(t,r,n,e){function a(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function i(l){try{s(e.next(l))}catch(p){u(p)}}function m(l){try{s(e.throw(l))}catch(p){u(p)}}function s(l){l.done?o(l.value):a(l.value).then(i,m)}s((e=e.apply(t,r||[])).next())})}function B(t,r,n){if(n||arguments.length===2)for(var e=0,a=r.length,o;e<a;e++)(o||!(e in r))&&(o||(o=Array.prototype.slice.call(r,0,e)),o[e]=r[e]);return t.concat(o||Array.prototype.slice.call(r))}const C=t=>t?(...r)=>t(...r):(...r)=>fetch(...r);class w extends Error{constructor(r,n="FunctionsError",e){super(r),this.name=n,this.context=e}}class T extends w{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class A extends w{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class S extends w{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var g;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(g||(g={}));class D{constructor(r,{headers:n={},customFetch:e,region:a=g.Any}={}){this.url=r,this.headers=n,this.region=a,this.fetch=C(e)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return j(this,arguments,void 0,function*(n,e={}){var a;let o,u;try{const{headers:i,method:m,body:s,signal:l,timeout:p}=e;let y={},{region:h}=e;h||(h=this.region);const O=new URL(`${this.url}/${n}`);h&&h!=="any"&&(y["x-region"]=h,O.searchParams.set("forceFunctionRegion",h));let f;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",f=s):typeof s=="string"?(y["Content-Type"]="text/plain",f=s):typeof FormData<"u"&&s instanceof FormData?f=s:(y["Content-Type"]="application/json",f=JSON.stringify(s)):s&&typeof s!="string"&&!(typeof Blob<"u"&&s instanceof Blob)&&!(s instanceof ArrayBuffer)&&!(typeof FormData<"u"&&s instanceof FormData)?f=JSON.stringify(s):f=s;let E=l;p&&(u=new AbortController,o=setTimeout(()=>u.abort(),p),l?(E=u.signal,l.addEventListener("abort",()=>u.abort())):E=u.signal);const c=yield this.fetch(O.toString(),{method:m||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),i),body:f,signal:E}).catch(_=>{throw new T(_)}),x=c.headers.get("x-relay-error");if(x&&x==="true")throw new A(c);if(!c.ok)throw new S(c);let b=((a=c.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),d;return b==="application/json"?d=yield c.json():b==="application/octet-stream"||b==="application/pdf"?d=yield c.blob():b==="text/event-stream"?d=c:b==="multipart/form-data"?d=yield c.formData():d=yield c.text(),{data:d,error:null,response:c}}catch(i){return{data:null,error:i,response:i instanceof S||i instanceof A?i.context:void 0}}finally{o&&clearTimeout(o)}})}}export{D as F,v as _,F as a,B as b};
