var b=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function F(e,t,r){const a=new URL(t,e);if(r)for(const[s,n]of Object.entries(r))n!==void 0&&a.searchParams.set(s,n);return a.toString()}async function A(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function q(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:n,headers:c}){const u=F(e.baseUrl,a,s),l=await A(e.auth),o=await t(u,{method:r,headers:{...n?{"Content-Type":"application/json"}:{},...l,...c},body:n?JSON.stringify(n):void 0}),d=await o.text(),g=(o.headers.get("content-type")||"").includes("application/json"),I=g&&d?JSON.parse(d):d;if(!o.ok){const $=g?I:void 0,f=$==null?void 0:$.error;throw new b((f==null?void 0:f.message)??`Request failed with status ${o.status}`,{status:o.status,icebergType:f==null?void 0:f.type,icebergCode:f==null?void 0:f.code,details:$})}return{status:o.status,headers:o.headers,data:I}}}}function x(e){return e.join("")}var R=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:x(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${x(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${x(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${x(e.namespace)}`}),!0}catch(t){if(t instanceof b&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof b&&r.status===409)return;throw r}}};function y(e){return e.join("")}var L=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${y(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof b&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof b&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},H=class{constructor(e){var a;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=q({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new R(this.client,t),this.tableOps=new L(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},S=class extends Error{constructor(e,t="storage",r,a){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=a}};function k(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var T=class extends S{constructor(e,t,r,a="storage"){super(e,a,t,r),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},U=class extends S{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const G=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Q=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},E=e=>{if(Array.isArray(e))return e.map(r=>E(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));t[s]=E(a)}),t},z=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function w(e){"@babel/helpers - typeof";return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(e)}function J(e,t){if(w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(w(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K(e){var t=J(e,"string");return w(t)=="symbol"?t:t+""}function M(e,t,r){return(t=K(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N(Object(r),!0).forEach(function(a){M(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const C=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},X=async(e,t,r,a)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e,n=s.status||500;if(typeof s.json=="function")s.json().then(c=>{const u=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||n+"";t(new T(C(c),n,u,a))}).catch(()=>{if(a==="vectors"){const c=n+"";t(new T(s.statusText||`HTTP ${n} error`,n,c,a))}else{const c=n+"";t(new T(s.statusText||`HTTP ${n} error`,n,c,a))}});else{const c=n+"";t(new T(s.statusText||`HTTP ${n} error`,n,c,a))}}else t(new U(C(e),e,a))},W=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!a?i(i({},s),r):(Q(a)?(s.headers=i({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(a)):s.body=a,t!=null&&t.duplex&&(s.duplex=t.duplex),i(i({},s),r))};async function v(e,t,r,a,s,n,c){return new Promise((u,l)=>{e(r,W(t,a,s,n)).then(o=>{if(!o.ok)throw o;if(a!=null&&a.noResolveJson)return o;if(c==="vectors"){const d=o.headers.get("content-type");if(o.headers.get("content-length")==="0"||o.status===204)return{};if(!d||!d.includes("application/json"))return{}}return o.json()}).then(o=>u(o)).catch(o=>X(o,l,a,c))})}function V(e="storage"){return{get:async(t,r,a,s)=>v(t,"GET",r,a,s,void 0,e),post:async(t,r,a,s,n)=>v(t,"POST",r,s,n,a,e),put:async(t,r,a,s,n)=>v(t,"PUT",r,s,n,a,e),head:async(t,r,a,s)=>v(t,"HEAD",r,i(i({},a),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,a,s,n)=>v(t,"DELETE",r,s,n,a,e)}}const Y=V("storage"),{get:_,post:p,put:P,head:Z,remove:B}=Y,h=V("vectors");var m=class{constructor(e,t={},r,a="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=G(r),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(k(r))return{data:null,error:r};throw r}}},ee=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(k(t))return{data:null,error:t};throw t}}};let D;D=Symbol.toStringTag;var te=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[D]="BlobDownloadBuilder",this.promise=null}asStream(){return new ee(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(k(t))return{data:null,error:t};throw t}}};const re={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},j={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ae=class extends m{constructor(e,t={},r,a){super(e,t,a,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,a){var s=this;return s.handleOperation(async()=>{let n;const c=i(i({},j),a);let u=i(i({},s.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const l=c.metadata;typeof Blob<"u"&&r instanceof Blob?(n=new FormData,n.append("cacheControl",c.cacheControl),l&&n.append("metadata",s.encodeMetadata(l)),n.append("",r)):typeof FormData<"u"&&r instanceof FormData?(n=r,n.has("cacheControl")||n.append("cacheControl",c.cacheControl),l&&!n.has("metadata")&&n.append("metadata",s.encodeMetadata(l))):(n=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,l&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(l))),(typeof ReadableStream<"u"&&n instanceof ReadableStream||n&&typeof n=="object"&&"pipe"in n&&typeof n.pipe=="function")&&!c.duplex&&(c.duplex="half")),a!=null&&a.headers&&(u=i(i({},u),a.headers));const o=s._removeEmptyFolders(t),d=s._getFinalPath(o),g=await(e=="PUT"?P:p)(s.fetch,`${s.url}/object/${d}`,n,i({headers:u},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{path:o,id:g.Id,fullPath:g.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const n=s._removeEmptyFolders(e),c=s._getFinalPath(n),u=new URL(s.url+`/object/upload/sign/${c}`);return u.searchParams.set("token",t),s.handleOperation(async()=>{let l;const o=i({upsert:j.upsert},a),d=i(i({},s.headers),{"x-upsert":String(o.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",o.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",o.cacheControl)):(l=r,d["cache-control"]=`max-age=${o.cacheControl}`,d["content-type"]=o.contentType),{path:n,fullPath:(await P(s.fetch,u.toString(),l,{headers:d})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(e);const s=i({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const n=await p(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),c=new URL(r.url+n.url),u=c.searchParams.get("token");if(!u)throw new S("No token returned by API");return{signedUrl:c.toString(),path:e,token:u}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;return a.handleOperation(async()=>await p(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers}))}async copy(e,t,r){var a=this;return a.handleOperation(async()=>({path:(await p(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,r){var a=this;return a.handleOperation(async()=>{let s=a._getFinalPath(e),n=await p(a.fetch,`${a.url}/object/sign/${s}`,i({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:a.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${a.url}${n.signedURL}${c}`)}})}async createSignedUrls(e,t,r){var a=this;return a.handleOperation(async()=>{const s=await p(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),n=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s.map(c=>i(i({},c),{},{signedUrl:c.signedURL?encodeURI(`${a.url}${c.signedURL}${n}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=a?`?${a}`:"",n=this._getFinalPath(e),c=()=>_(this.fetch,`${this.url}/${r}/${n}${s}`,{headers:this.headers,noResolveJson:!0});return new te(c,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>E(await _(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Z(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(k(a)&&a instanceof U){const s=a.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const n=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${r}${u}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await B(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var a=this;return a.handleOperation(async()=>{const s=i(i(i({},re),t),{},{prefix:e||""});return await p(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const a=i({},e);return await p(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const se="2.93.3",O={"X-Client-Info":`storage-js/${se}`};var ne=class extends m{constructor(e,t={},r,a){const s=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const n=s.href.replace(/\/$/,""),c=i(i({},O),t);super(n,c,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await _(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await _(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await p(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await P(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await p(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await B(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ce=class extends m{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=i(i({},O),t);super(a,s,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await p(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return await _(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await B(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!z(e))throw new S("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new H({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,n){const c=s[n];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(s,u),error:null}}catch(l){if(a)throw l;return{data:null,error:l}}}}})}},ie=class extends m{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=i(i({},O),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await h.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await h.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},oe=class extends m{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=i(i({},O),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},ue=class extends m{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=i(i({},O),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await h.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},le=class extends ue{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new he(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},he=class extends ie{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new de(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},de=class extends oe{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,i(i({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},pe=class extends ne{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new ae(this.url,this.headers,e,this.fetch)}get vectors(){return new le(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ce(this.url+"/iceberg",this.headers,this.fetch)}};export{pe as S};
